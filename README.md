Description
===========
This app provides a python module and tornado-based web service to connect a GitLab server with Jenkins. The service provides automated creation of jenkins build jobs on creation of new git repositories in GitLab. It also adds and triggers web hooks into those jobs to automate the build process after pushing code changes to GitLab. This functionality is triggered by setting up a jenkins.xml file at the root of the desired repository. This file should follow the config.xml format generated by Jenkins when modifying job settings.


Requirements
============
- python2.7
- python-yaml
- python-tornado (>=3.1.1)
- python-requests
- python-gitlab


Installation
============

1. Install tornado
2. Set the proper configuration in conf/settings.yaml
3. Copy conf/settings.yaml to /etc/gitlabjenkins/settings.yaml

Configuration
=============

The service depends on settings defined in:

    /etc/gitlabjenkins/settings.yaml


The following is an example settings file:

    # dev
    gitlabjenkins_server_url: http://gitlab.domain.com
    gitlabjenkins_server_port: 8888
    gitlab_server: http://gitlab.domain.com
    gitlab_private_token: KEY
    jenkins_server: http://user:passwd@jenkins.domain.com:port
    log_file: /var/log/git2j.log
    log_max_bytes: 20971520  # 20mb
    log_max_files: 5

Jenkins Project Setup
=====================

The GitLab Jenkins connector will create a project in Jenkins with the name 

  {group}-repo-{branch}

For example, if you are working on gitlab.domain.com/foo/bar.git the project would be:

  {foo}-bar

If you are in branch testing:

  {foo]-bar-{testing}

Jenkins XML
=====================

At the base of your GitLab project you must have a jenkins.xml.  This file must be of the syntax of a config.xml for a jenkins job.  The following keywords are replaced when pushed to Jenkins:

* USER_EMAIL
* GIT_REPOSITORY
* GIT_BRANCH
* GIT_URL
* PROJECT_NAME

If you are using the same build command throughout your projects, this allows you to have a common jenkins.xml for all projects.  The jenkins.xml included with the project is a very simple version.

